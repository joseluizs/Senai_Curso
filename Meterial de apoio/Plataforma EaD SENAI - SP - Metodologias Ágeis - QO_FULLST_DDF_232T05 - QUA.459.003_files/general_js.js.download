/*! For license information please see general_js.js.LICENSE.txt */
!function(){var e={466:function(){window.Blsm=window.Blsm||{},window.lng=function(e,n){var t=[].slice.call(arguments);$.isPlainObject(n)&&t.splice(1,1);var r=!1;if(n&&n.phrase){if(r=Blsm.InitialData&&Blsm.InitialData.phrases&&Blsm.InitialData.phrases[e])return n.replace&&(r=r.replaceAll("%s",n.replace)),_.escape(r);if(n.replace)return window.lng(e,n.replace)}t[0]=Blsm.translations&&Blsm.translations[e]||e,t[0].indexOf("|")>0&&(t[0]=t[0].split("|")[0]);try{return t.length>1?sprintf.apply(null,t):t[0]}catch(e){return console&&console.error&&console.error(e),t[0]}}},808:function(e,n,t){var r,o;!function(a){if(void 0===(o="function"==typeof(r=a)?r.call(n,t,n,e):r)||(e.exports=o),!0,e.exports=a(),!!0){var i=window.Cookies,s=window.Cookies=a();s.noConflict=function(){return window.Cookies=i,s}}}((function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function t(r){function o(){}function a(n,t,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var i=JSON.stringify(t);/^[\{\[]/.test(i)&&(t=i)}catch(e){}t=r.write?r.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in a)a[c]&&(s+="; "+c,!0!==a[c]&&(s+="="+a[c].split(";")[0]));return document.cookie=n+"="+t+s}}function i(e,t){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],i=0;i<a.length;i++){var s=a[i].split("="),c=s.slice(1).join("=");t||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=n(s[0]);if(c=(r.read||r)(c,l)||n(c),t)try{c=JSON.parse(c)}catch(e){}if(o[l]=c,e===l)break}catch(e){}}return e?o[e]:o}}return o.set=a,o.get=function(e){return i(e,!1)},o.getJSON=function(e){return i(e,!0)},o.remove=function(n,t){a(n,"",e(t,{expires:-1}))},o.defaults={},o.withConverter=t,o}((function(){}))}))}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){"use strict";t(466);var e={hasPermission:function(e){var n,t;return!!Blsm.user.isPowerManager||!(null===(n=Blsm.InitialData)||void 0===n||null===(t=n.permissions)||void 0===t||!t[e])},canAccessModule:function(e){var n=e.split("|");for(var t in n){var r,o;if(null!==(r=Blsm.InitialData)&&void 0!==r&&null!==(o=r.modules)&&void 0!==o&&o[n[t]])return!0}return!1},isFeatureEnabled:function(e){var n,t;return!(null===(n=Blsm.InitialData)||void 0===n||null===(t=n.features)||void 0===t||!t[e])},checkMod:function(e){var n;if(!e)return!0;var t={ENT:1,PRO:2}[e[1]];return(!e[0]||Blsm.isFeatureEnabled(e[0])||Blsm.canAccessModule(e[0]))&&(!t||t>=(null===(n=Blsm.InitialData)||void 0===n?void 0:n.plan))},isGuiFeatureEnabled:function(e){var n,t;return!(null===(n=Blsm.InitialData)||void 0===n||null===(t=n.gui_features)||void 0===t||!t[e])},GuiFeatureValue:function(e){var n,t;return null===(n=Blsm.InitialData)||void 0===n||null===(t=n.gui_features)||void 0===t?void 0:t[e]},ManagerPermissions:{MEMBERS_DIRECTOR:"members_director|1",CREATE_ASSIGNMENTS:"perm_assignments|1",SET_WEIGHTS:"perm_assignments|2",CREATE_MEETINGS:"perm_meetings|1",EDIT_MEETINGS:"perm_meetings|2",SET_ATTENDANCE:"perm_meetings|3",CONTENT_SHARE:"perm_content|1",VIEW_EVALUATIONS:"perm_evaluation|1",GENERAL_CONFIG:"perm_config|1",VIEW:"view",MANAGE:"manage",GROUP_ACTIVE:"0",GROUP_MANAGERS_ONLY:"1",GROUP_INVISIBLE:"2"},CanUser:function(e,n,t){var r,o,a,i=null===(r=Blsm.InitialData)||void 0===r||null===(o=r.base_permissions)||void 0===o||null===(a=o[n])||void 0===a?void 0:a[e];return t?i&&i[t]:i&&i.no_options},GetDomainGeneralOption:function(e){var n,t;return null===(n=Blsm.InitialData)||void 0===n||null===(t=n.general_options)||void 0===t?void 0:t[e]}},n=t(808),r=function(e,n){if(!e)return e;n=(((n||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,(function(e,t){return n.indexOf("<"+t.toLowerCase()+">")>-1?e:""}))},o={cookies:t.n(n)(),csrf_get:function(){return Blsm.cookies.get("csrf_token")||""},local_storage:{set:function(e,n){try{if(void 0===n)return window.localStorage.removeItem(e,n);window.localStorage.setItem(e,JSON.stringify(n))}catch(e){console.error("Storage error: "+e.message,"store cleared!"),window.localStorage.clear()}},get:function(e){var n=window.localStorage.getItem(e);try{return JSON.parse(n)}catch(e){return n}}},Match:function(e,n,t,o){if(!n)return source;t||(t={label:1}),o||(o={});var a,i,s=0;if(o.equals)for(i in t)s+=(n==(a=r(e[i]))?2:0)*t[i];else for(var c=!0,l=n.split(" "),u=0;u<l.length;u++){var p=!1,f=l[u],d=new RegExp(RegExp.escape(f),"i");for(i in t)s+=(f==(a=r(e[i]))?2:0)*t[i]+(d.test(a)?1:0)*t[i],p=p||d.test(a);c=c&&p}return!(!s||!c&&o.match_all)&&[s,e]},Filter:function(e,n,t,r){if(!n)return e;for(var o,a=[],i=[],s=0;s<e.length;s++)(o=this.Match(e[s],n,t,r))&&i.push(o);for(var c in i.sort((function(e,n){return n[0]-e[0]})),i)a.push(i[c][1]);return a},file_basename:function(e){return e.split(/[\/\\]/).pop()},file_extension:function(e){return e.substr(2+(~-e.lastIndexOf(".")>>>0))},file_is:function(e,n){var t=n&&Object.entries(Blsm.prm.mimetypes).find((function(e){return new RegExp(e[1]).test(n)}));if(t)return t[0];var r=this.file_extension(e).toLowerCase();return(t=r&&Object.entries(Blsm.prm.extensions).find((function(e){return e[1].indexOf(r)>=0})))?t[0]:void 0},file_is_image:function(e){return"img"===this.file_is(e)},gen_random_string:function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=n,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*r.length));return t},chat_with_group:function(e,n){window.bchat?window.bchat.chatWithGroup(e,n):Blsm.Error(lng("chat is disabled").caps())},hexToRgb:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,n,t,r){return n+n+t+t+r+r}));var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null},isDarkContrast:function(e){var n=Blsm.hexToRgb(e);return Math.round((299*parseInt(n.r)+587*parseInt(n.g)+114*parseInt(n.b))/1e3)>125},loadJS:function(e){var n=function(e){return new Promise((function(n,t){if(document.querySelector('script[src="'.concat(e,'"].ready')))return n();var r=document.createElement("script");r.src=e,r.onload=function(){r.classList.add("ready"),n()},r.onerror=t,document.head.appendChild(r)}))};return e.reduce((function(e,t){return e.then((function(){return n(t)}))}),Promise.resolve())},download_content:function(e,n,t){var r={};switch(o.file_extension(n)){case"csv":r.type="text/csv;charset=utf-8;";break;default:r.type="text/plain;charset=utf-8;"}var a=[e];t&&a.unshift("\ufeff");var i=new Blob(a,r);if(navigator.msSaveBlob)return navigator.msSaveBlob(i,n);var s=window.URL.createObjectURL(i),c=$("<a style='display: none;'/>").attr({href:s,download:n}).appendTo("body");c[0].click(),window.URL.revokeObjectURL(s),c.remove()},table_to_csv:function(e,n){n=Object.assign({download_file_name:!1,cell_prep_cb:function(e){return e.innerText.trim()},exclude_rows:[],skip_invisible_rows:!0},n);var t=[],r=[],a={"=":1,"-":1,"+":1,"@":1},i=["thead","tbody","tfoot"].map((function(e){return"> ".concat(e," > tr").concat(n.skip_invisible_rows?":visible":"")})).join(",");e.find(i).each((function(e,o){var i=[],s=0;$(o).find("> th, > td").each((function(e,t){for(var o=$(t);r[s]>0;)r[s]--,i.push("..."),s++;var c=n.cell_prep_cb(t);if(i.push(1===a[c[0]]?"\t"+c:c),o.attr("colspan")>1||o.attr("rowspan")>1){for(var l=o.attr("colspan")?o.attr("colspan")-1:0,u=o.attr("rowspan")?o.attr("rowspan")-1:0,p=s;p<=s+l;p++)p>s&&i.push("..."),r[p]=u;s+=l}s++})),t.push(i.filter((function(e,t){return!n.exclude_rows.includes(t)})))}));var s=t.map((function(e){return e.map((function(e){return'"'.concat(e.toString().replace(/"/g,'""'),'"')})).join(",")})).join("\r\n");if(!n.download_file_name)return s;o.download_content(s,n.download_file_name,!0)}},a=[],i=void 0,s=function e(n,t,r){n.pushManager&&n.pushManager.getSubscription().then((function(o){o?new Uint8Array(o.options.applicationServerKey).toString()!==r.toString()?o.unsubscribe().then((function(){e(n,t,r)})):a.push("existing sub "+JSON.stringify(o)):Notification.requestPermission((function(e){"granted"===e&&n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}).then((function(e){a.push("new sub "+JSON.stringify(e)),fetch((Blsm.prm.Mainref+"api?/Users/pwa_push_subscribe/"+t).csrf(),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.toJSON())}).catch((function(){return e.unsubscribe.bind(e)}))}))}))}))},c={init:function(e){if(!e.script)return console.err("pwa script missing");e.host===location.host&&(e.clear&&window.caches&&caches.keys().then((function(e){return Promise.all(e.map((function(e){return a.push("PWA cache clear: "+e),caches.delete(e)})))})),navigator.serviceWorker&&navigator.serviceWorker.register(Blsm.prm.Mainref+e.script).then((function(n){i=n,console.info("Service Worker Registered - "+e.script),e.clear?function(e){e.pushManager.getSubscription().then((function(e){e&&e.unsubscribe().then((function(){a.push("push notifications subscription removed")}))}))}(n):e.pushKey&&e.app&&s(n,e.app,function(e){for(var n=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(n),r=new Uint8Array(t.length),o=0;o<t.length;++o)r[o]=t.charCodeAt(o);return r}(e.pushKey))})).catch((function(e){console.error("Service Worker Error",e)})))},uninstall:function(){navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((function(e){for(var n in e)0===location.href.indexOf(e[n].scope)&&e[n].unregister()}))},getRegistration:function(){return i},getLog:function(){return a}};function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){p(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var r,o,a=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw o}}return a}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return d(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var m=null,g=null,h={favicon_dot:function(e){if(e){var n=$("link[rel='shortcut icon']");if(null===m){m=n.attr("href");var t=document.createElement("canvas");t.width=16,t.height=16;var r=t.getContext("2d"),o=new Image;o.crossOrigin="Anonymous",o.onload=function(){r.drawImage(o,0,0,16,16),r.beginPath(),r.arc(12,12,3.5,0,2*Math.PI),r.fillStyle="#ff9800",r.fill(),g=t.toDataURL("image/x-icon"),n.attr("href",g)},o.src=m}else n.attr("href",g)}else m&&$("link[rel='shortcut icon']").attr("href",m)},state_push:function(e,n){history.pushState&&(history.state&&history.state.dummy_for_dialog||(history.pushState({dummy_for_dialog:1},""),n&&e.listenToOnce(Backbone,"Window:popstate",n)))},state_remove:function(e){history.state&&history.state.dummy_for_dialog?(e&&Backbone.listenToOnce(Backbone,"Window:popstate",e),history.back()):e&&e()},isIE:function(){return navigator.userAgent.indexOf("Trident")>=0},isMobileSafari:function(){return navigator.userAgent.indexOf("iPhone")>=0&&navigator.userAgent.indexOf("CriOS")<0},group_access_options:function(){var e={};return e[lng("controlled by managers").caps()]={private:lng("private").caps()+" - "+lng("owner only").caps(),manager_register:lng("departmental").caps()+" - "+lng("org' unit managers add their own users").caps()},Blsm.isFeatureEnabled("course_registartion")&&(e[lng("user registration").caps()]={public:lng("public").caps()+" - "+lng("anyone can join").caps(),register:lng("requested").caps()+" - "+lng("requires an approval sequence").caps()}),e},upload_files:function(e){var n=!!window.FormData,t=function(e){try{return $.parseJSON(e)}catch(n){return e}},r=function e(t,r,o){if($.isPlainObject(o)||$.isArray(o))for(var a in o)e(t,r+"["+a+"]",o[a]);else n?t.append(r,o):t.append($("<input type='hidden'>").attr("name",r).val(o))};-1<e.url.indexOf("api?")&&0>e.url.indexOf("&csrf_token=?")&&Blsm.csrf_get()&&(e.url+="&csrf_token="+encodeURIComponent(Blsm.csrf_get())),Array.prototype.forEach.call(e.files,(function(o){if(o.id="dnduploadfile_"+Math.floor(999999*Math.random()),n){var a=new FormData;if(a.append("file",o),e.data)for(var i=0,s=Object.entries(e.data);i<s.length;i++){var c=f(s[i],2),l=c[0],u=c[1];r(a,l,u)}var p=new XMLHttpRequest;p.open("POST",e.url),p.onload=function(){4===p.readyState&&(200===p.status?e.on_complete&&e.on_complete(o,t(p.responseText)):e.on_error?e.on_error(o,t(p.responseText)):Blsm.Error(t(p.responseText)))},p.upload.onprogress=e.on_progress&&function(n){n&&n.lengthComputable&&e.on_progress(o,n.loaded/n.total*100|0)},e.on_start&&e.on_start(o,p),p.send(a)}else if(e.file_el){var d=e.file_el.cloneNode(!0);e.file_el.removeAttribute("id"),e.file_el.parentNode.appendChild(d);var m=document.createElement("iframe"),g="dndiframeupload_"+Math.floor(999999*Math.random());m.setAttribute("name",g),m.style.display="none";var h=document.createElement("form");if(h.setAttribute("method","post"),h.setAttribute("enctype","multipart/form-data"),h.setAttribute("target",g),h.setAttribute("action",e.url),h.appendChild(e.file_el),h.style.display="none",h.insertAdjacentHTML("beforeend",'<input type="hidden" name="ServiceStarter::$iframe" value="1"/>'),e.data)for(var v=0,_=Object.entries(e.data);v<_.length;v++){var b=f(_[v],2),y=b[0],w=b[1];r(h,y,w)}h.appendChild(e.file_el);var S=document.getElementsByTagName("body")[0];S.appendChild(m),S.appendChild(h),m.onload=function(){var n=m.contentDocument.body.innerText;m.parentNode.removeChild(m),h.parentNode.removeChild(h),e.on_complete(o,t(n))},e.on_start&&e.on_start(o),h.submit()}}))},uploadFiles:function(e){if(window.FormData){var n=new FormData;if(-1<e.url.indexOf("api?")&&0>e.url.indexOf("&csrf_token=?")&&Blsm.csrf_get()&&(e.url+="&csrf_token="+encodeURIComponent(Blsm.csrf_get())),Array.prototype.forEach.call(e.files,(function(e,t){e.id="upload"+Math.floor(999999*Math.random()),n.append("file[".concat(t,"]"),e)})),e.data)for(var t=0,r=Object.entries(e.data);t<r.length;t++){var o=f(r[t],2),a=o[0],i=o[1];n.append(a,i)}var s=new XMLHttpRequest;s.open("POST",e.url),s.onload=function(){4===s.readyState&&(200===s.status?e.on_complete&&e.on_complete(s.responseText):e.on_error&&e.on_error(s.responseText))},s.upload.onprogress=e.on_progress&&function(n){n&&n.lengthComputable&&e.on_progress(n.loaded/n.total*100|0)},e.on_start&&e.on_start(file,s),s.send(n)}},setJqueryAjaxPreFilter:function(){$.ajaxPrefilter((function(e,n,t){if(-1<e.url.indexOf("api?")){t.setRequestHeader("origin_hash",encodeURIComponent(window.location.hash));var r=Blsm.csrf_get();r&&t.setRequestHeader("X-CSRF-TOKEN",r);var o=$.deparam(location.search).assignment_token;o&&(e.url=e.url+"&assignment_token="+encodeURIComponent(o))}}))},lesson_type_lng:function(e){var n=Blsm.helpers.lesson_types().find((function(n){return n.value===e.toLowerCase()}));return n&&n.label},lesson_types:function(){return[{value:"file",label:lng("file").caps()},{value:"test",label:lng("test").caps()},{value:"survey",label:lng("survey").caps()},{value:"courseware",label:lng("courseware").caps()},{value:"evaluation",label:lng("evaluation").caps()},{value:"form",label:lng("form").caps()},{value:"blog",label:lng("blog post").caps()},{value:"text",label:lng("text").caps()},{value:"certificate",label:lng("diplomas").caps()}]},setWindowError:function(e){window.onerror=function(n,t,r,o){if(console&&console.warn({errorMsg:n,url:t,lineNumber:r,colNumber:o}),n){t=t||"";var a=document.createElement("a");if(a.href=t,window.location.hostname===a.hostname){if(!_.find(["collaboration.js","collaboration_vendors.js","tinymce.min.js","vendors.js","jquery-ui","vendors.js","lib-jitsi-meet","external_api"],(function(e){return-1<t.indexOf(e)}))){["Failed to parse URL parameter value: undefined","ResizeObserver loop limit exceeded","Uncaught SyntaxError: Unexpected token <"].indexOf(n)>-1||e&&!t||Blsm.Error("JS "+n+" ("+r+":"+o+")")}}}}},setJqueryAjaxError:function(){$(document).ajaxError((function(e,n,t,r){if("abort"!==r&&console&&console.error("Error (ajax): ",e,n,t,r),!([0,404,502,503,504].indexOf(n.status)>-1)){if(!_.find(["/api?/notifications/","arrowchat","ipapi.co/"],(function(e){return-1<t.url.indexOf(e)})))if(n.responseJSON&&n.responseJSON.redirect)nav(n.responseJSON.redirect,{replace:!0});else{var o=n.responseJSON&&n.responseJSON.error_msg||n.responseText||lng("an error occurred");Blsm.prm.LOCALHOST&&n.responseJSON&&n.responseJSON.unexpected_output&&(o+=n.responseJSON.unexpected_output),Blsm.Error(lng("error").caps()+" ("+lng("server")+"): "+o.caps())}}})).ajaxComplete((function(e,n,t){if(200==n.status&&n.responseJSON&&n.responseJSON.res&&"1"!=n.responseJSON.res){var r=n.responseJSON.res||lng("an error occurred");Blsm.Error("ajaxComplete error: "+r.caps())}}))},setBackboneWrappers:function(e){Backbone.originalAjax=Backbone.ajax,Backbone.ajax=function(){return arguments[0].url=encodeURI(arguments[0].url),Backbone.originalAjax.apply(Backbone.$,arguments)},Backbone.originalSync=Backbone.sync,Backbone.sync=function(n,t,r){var o=_.isFunction(t.url)?t.url():t.url;return o&&(r=r||{},o.startsWith(e)||(r.url=e+o)),Backbone.originalSync(n,t,r)}},get_targets:function(e,n,t){return u(u({user:(e||lng("user")).caps(),manager:lng("%s's direct manager",e).caps(),users_indirect_manager:lng("%s's indirect manager",e).caps(),users_managers_manager:lng("%s's manager's manager",e).caps(),user_professional_manager:lng("%s's professional manager",e).caps(),user_hr_manager:lng("%s's human resources coordinator",e).caps(),personal_coach:lng("%s's personal coach",e).caps()},t&&{coach:lng("%s's assigned coach",e).caps()}),(void 0===n||n)&&{other:lng("users, roles, workspaces").caps(!1)})}};lng("off"),lng("immediate"),lng("minutes"),lng("minutes"),lng("hour"),lng("hours"),lng("hours"),lng("hours"),lng("day"),lng("days");String.prototype.csrf=function(){if(this.includes("&csrf_token="))return this;var e=Blsm.csrf_get();return e?this+"&csrf_token="+encodeURIComponent(e):this},String.prototype.caps=function(e){return this.replace(!1!==e?/^(.)/:/(?:^'?|\s'?)\S/g,(function(e){return e.toUpperCase()}))},String.prototype.truncate=function(e,n){return!e||this.length<=e?this:this.substring(0,e-1).trim()+(n||"…")},String.prototype.nl2br=function(){return this.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")},String.prototype.br2nl=function(){return this.replace(/<br\s*\/?>/gm,"\n")},String.prototype.taskify=function(){return this.replace(/(\s|^|>)T#(\d+)(\s|$|,|<|\.)/g,'$1<a href="#edit/task/$2">T#$2</a>$3')},String.prototype.linkify=function(e){var n=Autolinker.link(this,{stripPrefix:!1});if(!e)return n;var t=$("<div></div>").html(n);return t.find("a").each((function(){var e;try{e=$.deparam(this.search)}catch(e){return!0}if(this.classList.contains("attached-file")){var n=this.search.substring(this.search.indexOf("name=")+5);this.innerText=decodeURIComponent(n)}var t,r,o=Blsm.file_extension(e.name||"").toLowerCase();if("mp4"===o||"mov"===o)$(this).attr("data-preview","mp4");else if(["csv","xls","xlsx","txt","pdf"].includes(o))$(this).attr("data-preview",o);else if(Blsm.file_is_image(this.pathname)||this.pathname.includes("GetFile")&&Blsm.file_is_image(this.search))$(this).attr("data-preview","img"),/https?:/i.test(this.innerHTML)&&(this.innerHTML='<img src="'.concat(this.href,'" title="').concat(this.href.indexOf("/GetFile?")?"":this.href,'" style="display:block;" />'));else{var a=(t=this.search,(r=(t=decodeURIComponent(t)).match(/&name=([%\w\-\.]+\.\w{2,4})($|&)/))||(r=t.match(/&([%\w\-\.]+\.\w{2,4})$/))?r[1]:void 0);a&&/https?:/i.test(this.innerHTML)&&(this.innerHTML='<span class="icon icon-attachment" ></span> '.concat(a))}})),t.find("img:not(.emojione)").each((function(e,n){return $(n).wrap($("<a/>").attr({"data-preview":"img",href:n.src}))})),t.html()},String.prototype.emojify=function(){return emojione.ascii=!0,emojione.toImage(this)},String.prototype.emoji_prepare=function(){return this},String.prototype.emoji_edit=function(){return emojione.ascii=!1,emojione.shortnameToUnicode(this)},String.prototype.comment_markup=function(){var e=this.replace(/\r/g,"").replace(/(\s|^)\*([^*\n]*)\*(\s|$|,|\.)/gm,"$1<b>$2</b>$3").replace(/(\s|^)_([^_\n]*)_(\s|$|,|\.)/gm,"$1<u>$2</u>$3").replace(/(\s|^)`([^`\n]*)`(\s|$|,|\.)/gm,"$1<i>$2</i>$3").replace(/(\s|^)~([^~\n]*)~(\s|$|,|\.)/gm,"$1<s>$2</s>$3").replace(/(\s|^)!([^!\n]*)!(\s|$|,|\.)/gm,'$1<span style="color:#FF0042;">$2</span>$3').replace(/(\s|^|>)T#(\d+)(\s|$|,|<|\.)/g,'$1<a href="#edit/task/$2">T#$2</a>$3');return e=e.replace(/^[#-](.*)(\n|$)/gm,(function(e,n){return"#"===e.charAt(0)?"<ol><li>"+n+"</li></ol>":"<ul><li>"+n+"</li></ul>"})).replace(/(<\/ul><ul>|<\/ol><ol>)/g,"")},String.prototype.mentions=function(e){return this.replace(/@\[#(\d+)\/([^\]]+)\]/g,e?"@$2":'<span class="mentions_box">@$2</span>')},String.prototype.stripTags=function(){return this.br2nl().replace(/<[^>]*>/gi,"")},String.prototype.isRtl=function(){return/[\u0591-\u07FF]/.test($("<div></div>").append(this).text().replace(/^[\s!-@[-`{-\u00bf\u1ffd-\u208f\u20a0-\u2bff]+/g,"").charAt(0))},String.prototype.repeat||(String.prototype.repeat=function(e){return new Array(e+1).join(this)}),RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},$.extend(!0,Blsm,e,o,{PWA:c},{helpers:h}),Blsm.beacon=function(e,n){if(navigator.sendBeacon&&window.FormData){e.includes("api?")&&(e=e.csrf());var t=new FormData;for(var r in n)t.append(r,n[r]);!1===navigator.sendBeacon(e,t)&&console.error("navigator.sendBeacon failed!")}else $.ajax(e,{method:"POST",data:n})},window.addEventListener("DOMContentLoaded",(function(){if(Blsm.prm.inactivity_logout>0&&Blsm.user.id>0){var e=0;window.localStorage.setItem("last_activity",(new Date).getTime());var n=function(){var n=(new Date).getTime();n>e+1e3&&(e=n,window.localStorage.setItem("last_activity",n))};window.addEventListener("scroll",n),window.addEventListener("click",n),window.addEventListener("keydown",n)}}))}()}();